**Descripción de estados:**

- **BORRADOR:** Editable, no afecta producción
- **CONFIRMADO:** Congelado, listo para planificar
- **EN_PRODUCCION:** Asignado a lotes de producción
- **PRODUCIDO:** Inventario disponible para despacho
- **DESPACHADO:** En tránsito a ubicaciones
- **ENTREGADO:** Confirmado recepción por cliente

---

#### RF-PED-003: Consolidación de Pedidos

**Descripción:** Vista consolidada de pedidos por fecha.

**Funcionalidades:**

- Ver todos los pedidos de una fecha específica across todas las regiones
- "Consolidado Nacional": Suma total por producto independiente de región
- Exportar consolidado a Excel/PDF

---

#### RF-PED-004: Historial de Cambios

**Descripción:** Trazabilidad completa de modificaciones.

**Requerimientos:**

- Registrar usuario y timestamp de cada creación/modificación
- Snapshot de valores antes de cambios significativos
- No permitir eliminación física de pedidos confirmados (solo cancelación lógica con motivo obligatorio)

---

### 1.3 Módulo de Producción

#### RF-PROD-001: Generación de Lotes

**Descripción:** Conversión de pedidos a órdenes de producción.

**Proceso:**

1. Agrupar pedidos confirmados por producto
2. Calcular cantidad total necesaria: Σ(ubicaciones)
3. Permitir división en lotes si:
   - Capacidad de equipo limitada
   - Fechas de entrega diferidas
4. Generar código de lote: `LOTE-YYYYMMDD-NNN` (NNN = secuencial)

---

#### RF-PROD-002: Órdenes de Producción

**Atributos:**

- Código de lote (único)
- Producto a fabricar
- Cantidad solicitada (del pedido)
- Cantidad real producida (input al finalizar)
- Fecha programada inicio/fin
- Fecha real inicio/fin
- Estado: pendiente | en_proceso | completado | cancelado
- Responsable de producción
- Observaciones

---

#### RF-PROD-003: Asignación de Pedidos a Lotes

**Descripción:** Vinculación entre pedidos y producción.

**Reglas:**

- Un lote puede cubrir múltiples pedidos del mismo producto
- Sistema debe mostrar qué pedidos alimentaron cada lote
- Permitir "split": Si se producen 100 y se pidieron 120, marcar pedido como "Parcial" y generar pendiente

---

#### RF-PROD-004: Cierre de Producción

**Descripción:** Finalización de lote y entrada a inventario.

**Acciones al cerrar:**

1. Input de cantidad real producida
2. Input de merma/calidad rechazada (opcional)
3. Generación automática de movimiento de entrada a inventario
4. Actualización de pedidos afectados a estado "Listo para despacho"

---

### 1.4 Módulo de Inventario y Despacho

#### RF-INV-001: Control de Stock por Ubicación

**Tipos de movimiento:**

- ENTRADA_PRODUCCION: Del lote terminado
- SALIDA_DESPACHO: A ubicación cliente
- AJUSTE: Por inventario físico
- TRANSFERENCIA: Entre depósitos (Fase 2)

---

#### RF-INV-002: Despacho

**Flujo:**

1. Listar pedidos en estado "PRODUCIDO"
2. Usuario selecciona pedido y genera "Guía de Despacho"
3. Sistema descuenta del inventario central
4. Marca pedido como "DESPACHADO" con fecha/hora
5. Generación de documento de transporte imprimible

---

#### RF-INV-003: Tracking de Entrega

**Descripción:** Confirmación final del pedido.

**Estados finales:**

- ENTREGADO: Confirmado por cliente o sistema
- RECHAZADO: Con motivo obligatorio (producto dañado, cantidad incorrecta, etc.)
- Adjunto opcional: Firma digital o foto de entrega

---

### 1.5 Módulo de Reportes

#### RF-REP-001: Reportes Operativos

| Reporte              | Frecuencia | Contenido                         |
| -------------------- | ---------- | --------------------------------- |
| Pedidos del día      | Diario     | Consolidado nacional por producto |
| Producción pendiente | Diario     | Lotes por iniciar/completar       |
| Despachos            | Diario     | Guías generadas, pendientes       |
| Cumplimiento         | Semanal    | % pedidos entregados a tiempo     |
| Inventario           | Semanal    | Stock por ubicación/producto      |

---

#### RF-REP-002: Dashboard Ejecutivo

**KPIs visuales obligatorios:**

- Pedidos hoy vs. ayer vs. promedio mes
- Producción: Programado vs. Realizado (barras de progreso)
- Top 5 productos más pedidos (gráfico pastel)
- Top 5 ubicaciones con mayor volumen (gráfico barras)
- Alertas: Pedidos atrasados, stock crítico (badge rojo)

---

#### RF-REP-003: Exportación

**Formatos:**

- Excel (.xlsx) con formato similar al Excel actual para transición suave
- PDF para documentos oficiales (despachos, guías)

---

## 2. REQUERIMIENTOS NO FUNCIONALES

### 2.1 Rendimiento

| Código      | Descripción                       | Métrica       |
| ----------- | --------------------------------- | ------------- |
| RNF-PER-001 | Tiempo de carga de pantallas      | < 2 segundos  |
| RNF-PER-002 | Generación de reportes mensuales  | < 10 segundos |
| RNF-PER-003 | Usuarios concurrentes simultáneos | 50 usuarios   |

---

### 2.2 Seguridad

| Código      | Descripción                                                                       |
| ----------- | --------------------------------------------------------------------------------- |
| RNF-SEG-001 | Autenticación con usuario/contraseña (mínimo 8 caracteres, 1 mayúscula, 1 número) |
| RNF-SEG-002 | Sesiones expiran después de 30 minutos de inactividad                             |
| RNF-SEG-003 | Encriptación de contraseñas con bcrypt o Argon2                                   |
| RNF-SEG-004 | HTTPS obligatorio en todo el sitio (TLS 1.3)                                      |
| RNF-SEG-005 | Backup automático diario de base de datos (retención 30 días)                     |

---

### 2.3 Disponibilidad

| Código      | Descripción                                                  |
| ----------- | ------------------------------------------------------------ |
| RNF-DIS-001 | Uptime 99.5% en horario laboral (8:00 - 18:00)               |
| RNF-DIS-002 | Mantenimientos programados fuera de horario de producción    |
| RNF-DIS-003 | Modo consulta offline (caché local) para reportes históricos |

---

### 2.4 Usabilidad

| Código      | Descripción                                                |
| ----------- | ---------------------------------------------------------- |
| RNF-USA-001 | Interfaz responsive: funciona en tablet 10" mínimo         |
| RNF-USA-002 | Web-based: no requiere instalación de cliente              |
| RNF-USA-003 | Compatible con Chrome, Firefox, Edge (últimas 2 versiones) |
| RNF-USA-004 | Tiempo de aprendizaje < 2 horas para usuario básico        |
| RNF-USA-005 | Navegación con teclado tipo Excel (flechas, tab, enter)    |

---

### 2.5 Escalabilidad

| Código      | Descripción                                                              |
| ----------- | ------------------------------------------------------------------------ |
| RNF-ESC-001 | Arquitectura preparada para 10x volumen actual sin rediseño              |
| RNF-ESC-002 | Base de datos soporta 5 años de historial sin degradación de performance |

---

## 3. MODELO DE DATOS (Resumen)

### Entidades Principales:

**USUARIOS** (id, nombre, email, password_hash, rol, activo, creado)

**PRODUCTOS** (id, codigo_interno, familia, linea, presentacion, unidad_medida, factor_conversion, activo)

**UBICACIONS** (id, codigo, nombre, tipo, region, direccion, contacto, activo)

**PEDIDOS** (id, fecha_pedido, region, estado, usuario_id, creado, actualizado, observaciones)

**PEDIDO_DETALLE** (id, pedido_id, producto_id, ubicacion_id, cantidad_solicitada, cantidad_producida, cantidad_despachada)

**LOTES** (id, codigo, producto_id, cantidad_programada, cantidad_real, fecha_programada, fecha_real_inicio, fecha_real_fin, estado, responsable)

---

## 4. CRITERIOS DE ACEPTACIÓN

### Pruebas de Usuario (UAT):

1. **UAT-001:** Crear pedido del 04/02/2026 para región 04SC con 20 productos en menos de 5 minutos
2. **UAT-002:** Generar lote de producción, completarlo, y verificar actualización automática de inventario
3. **UAT-003:** Exportar reporte consolidado nacional y validar que coincida con cálculo manual Excel (diferencia < 1%)
4. **UAT-004:** 3 usuarios simultáneos editando diferentes pedidos sin conflictos de concurrencia

### Métricas de Éxito:

- 100% de pedidos del último mes migrados correctamente
- Reducción del 50% en tiempo de ingreso de pedido vs. Excel
- Cero pérdida de datos en primer mes de operación
- 90% de usuarios reportan satisfacción ≥ 7/10

---

## 5. ANEXOS

### Anexo A: Familias de Producto

| Familia | Descripción      | Presentaciones              |
| ------- | ---------------- | --------------------------- |
| YUNGAS  | Línea principal  | 70, 250, 400, 1000 (M y G)  |
| NE      | Línea secundaria | 150, 250, 500, 1000 (M y G) |
| ALMA    | Línea terciaria  | 340, 1000 (M y G)           |

### Anexo B: Regiones Detectadas en Excel

- 04, 04SC (Santa Cruz)
- 09LP, 09SC (La Paz)
- 11SC
- 19

---

**Fin del documento**
